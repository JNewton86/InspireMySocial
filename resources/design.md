# Project Design Doc - Inspire My Social Service Design

## 1. Problem Statement

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A mortgage loan officer in today's social media driven world needs to generate content daily on FaceBook, LinkedIn, Twitter, and YouTube in order to stay in front of clients, and grow their sphere of influence in the market. However it is often time consuming and difficult for the average loan officer to balance the time involved in creating the content consistently and still grow their business, conduct client meetings, manage partner relationships, and proactively manage their pipeline of loans that are under contract. Chat GPT can assist with this, however it is not easy to create polished content for the average user. Utilizing detailed prompts provided as part of the API call to ChatGPT allows one of Inspire My Social's users to create the social media topic quickly and efficiently. This Service will allow users to create posts for FB, Twitter, YT shorts, YT Long content, and LinkedIn using OpenAI’s APIs, store the results in a DynamoTable, and review their prior posts. I intend to have a user Table as well as a GSI tracking available token balances. Each time a prompt is generated the user's available token balance would decrease.


## 2. Top Questions to Resolve in Review

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1) Should a db be used to store user data or just retain in Cognito? A lambda trigger can be used to save info into DDB after user confirms signup

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2) Will the instructional staff allow me to make calls to a third party service such as OpenAI and Stripe API in my capstone?

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3) API design question. Should each type of content created have it's own API or one of the attributes passed into my service would be which type of content is being created?


## 3. Use Cases

u1) Allow end user to create free account

u2) Allow end user to check token balance

u3) Allow end user to create content for FB

u4) Allow end users to see paginated results on Dashboard of their search items, with-pop up button for each of the scripts creating tools.

u5) Allow end user to create content for Twitter

u6) Allow end user to create content for LinkedIn

u7) Allow end user to create content for YT long form

u8) Allow end user to create content for YT Short

u9) Allow end user to upgrade account or “buy tokens (Stripe has an API that is free to use and comes with dummy data. For the scope of this project I would use the dummy account and dummy info only.)




## 4. Project Scope

### 4.1. In Scope

&nbsp;&nbsp;&nbsp;&nbsp;A) Create and retrive social media content created using ChatGPT

&nbsp;&nbsp;&nbsp;&nbsp;B) Tracking and updating a user's token balance when they process a request to create content, or when they "dummy buy" more tokens. Allow an employee account to add more tokens

&nbsp;&nbsp;&nbsp;&nbsp;C) Retrieving all content a user previously created

&nbsp;&nbsp;&nbsp;&nbsp;D) Allow employee account to make revisions to hidden system prompts for each type of content

### 4.2. Out of Scope

&nbsp;&nbsp;&nbsp;&nbsp; Updateing previously created content

&nbsp;&nbsp;&nbsp;&nbsp; setting up monthly subscription for tokens

&nbsp;&nbsp;&nbsp;&nbsp; Allowing employee to create new content types.

## 5. Proposed Architecture Overview

This initial iteration will provide the minimum lovable product (MLP) including creating an account, generating a prompt, retrieving your token balance, and updating account type.

We will use API Gateway and Lambda to create five endpoints (`GetContentbyUser`,`UpdateUserTokenBalance`,
`CreateContent`, `DeleteContent`, `CreateAccount?`, `GetTokenBalance1`,)

that will handle the creation, update, and retrieval of social media content to satisfy our requirements.

We will store content generated by a user in DynamoDB. users themselves will be stored in Cognito, but a lambda trigger will be used to popualte the user table.
themselves will also be stored in DynamoDB. For simpler song list retrieval, we
will store the list of songs in a given playlist directly in the playlists
table.

AmazonMusicPlaylistService will also provide a web interface for users to manage
their playlists. A main page providing a list view of all of their playlists
will let them create new playlists and link off to pages per-playlist to update
metadata and add songs.

## 6. API

### 6.1. Public Models

```
// PlaylistModel

String id;
String name;
String customerId;
Integer songCount;
List<String> tags;
```

```
// SongModel

String asin;
String album;
Integer trackNumber;
String title;
```

### 6.2. Get Playlist Endpoint

* Accepts `GET` requests to `/playlists/:id`
* Accepts a playlist ID and returns the corresponding PlaylistModel.
    * If the given playlist ID is not found, will throw a
      `PlaylistNotFoundException`

### 6.3. Create Playlist Endpoint

* Accepts `POST` requests to `/playlists`
* Accepts data to create a new playlist with a provided name, a given customer
  ID, and an optional list of tags. Returns the new playlist, including a unique
  playlist ID assigned by the Music Playlist Service.
* For security concerns, we will validate the provided playlist name does not
  contain any invalid characters: `" ' \`
    * If the playlist name contains any of the invalid characters, will throw an
      `InvalidAttributeValueException`.

### 6.4. Update Playlist Endpoint

* Accepts `PUT` requests to `/playlists/:id`
* Accepts data to update a playlist including a playlist ID, an updated playlist
  name, and the customer ID associated with the playlist. Returns the updated
  playlist.
    * If the playlist ID is not found, will throw a `PlaylistNotFoundException`
* For security concerns, we will validate the provided playlist name does not
  contain invalid characters: `" ' \`
    * If the playlist name contains invalid characters, will throw an
      `InvalidAttributeValueException`

![Client sends submit playlist update form to Website Playlist page. Website
playlist page sends an update request to UpdatePlaylistActivity.
UpdatePlaylistActivity saves updates to the playlists
database.](images/example_design_document/UpdatePlaylistSD.png)

### 6.5. Add Song To Playlist Endpoint

* Accepts `POST` requests to `/playlists/:id/songs`
* Accepts a playlist ID and a song to be added. The song is specified by the
  album's ASIN and song track number
    * If the playlist is not found, will throw a `PlaylistNotFoundException`
    * If the given album ASIN doesn't exist, or if the given track number does
      not exist for the album ASIN, will throw an `AlbumTrackNotFoundException`
* By default, will insert the new song to the end of the playlist
    * If the optional `queueNext` parameter is provided and is `true`, this API
      will insert the new song to the front of the playlist so that it will be
      the next song played

![Client submits the add song form to the Website Add Song page. The website
add song page sends an add song request to the AddSongToPlaylistActivity. The
AddSongToPlaylistActivity save the updated playlist song list in the playlists
database.](images/example_design_document/AddSongSD.png)

### 6.6. Get Playlist Songs Endpoint

* Accepts `GET` requests to `/playlists/:id/songs`
* Retrieves all songs of a playlist with the given playlist ID
    * Returns the song list in default playlist order
    * If the optional `order` parameter is provided, this API will return the
      song list in order, reverse order, or shuffled order, based on the value
      of `order`
        * DEFAULT - same as default behavior, returns songs in playlist order
        * REVERSED - returns playlist songs in reversed order
        * SHUFFLED - returns playlist songs in a randomized order
* If the playlist ID is found, but contains no songs, the songs list will be
  empty
* If the playlist ID is not found, will throw a `PlaylistNotFoundException`

![The client visits the playlist page of the Website Playlist. The Website
playlist page sends a get song request to the GetPlaylistSongsActivity. The
GetPlaylistSongsActivity calls the playlists database to load the playlist. The
playlists database returns the playlist item to the GetPlaylistSongsActivity.
The GetPlaylistSongsActivity returns a List<SongModel> to the Website Playlist
page. The Website playlist page presents a list of songs to the
client.](images/example_design_document/GetPlaylistSD.png)

### 6.7. Get Playlists for User Endpoint

* Accepts `GET` requests to `/playlists/:customerId`
* Accepts a customer ID and returns a list of PlaylistModels created by that customer.
    * If the given customer has not created any playlists, an empty list will be returned

## 7. Tables

### 7.1. `playlists`

```
id // partition key, string
name // string
customerId // string, customerId-playlistId-index partition key
songCount // number
tags // stringSet
songList // list
```

- `customerId-playlistId-index` includes ALL attributes

### 7.2. `album_tracks`

```
asin // partition key, string
track_number // sort key, number
album_name // string
song_title // string
```